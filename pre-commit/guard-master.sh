#!/usr/bin/env bash

#Some formatting variables
red=$(tput setaf 1)       
magenta=$(tput setaf 203) 
cyan=$(tput setaf 6)      
normal=$(tput sgr0)       

# General patch variables
gitroot=`git rev-parse --show-toplevel 2> /dev/null`
git_dir=`git rev-parse --git-dir 2> /dev/null`

guard_master() {
  local branch=`git rev-parse --abbrev-ref HEAD`

  if [[ "$branch" == "master" || "$branch" == "dev" ]]; then
    echo -e "${red}"
    echo -e "                    ░▓████████████████████████▒░                    "
    echo -e "                 ░▓█████▓▒░░░░░░░░░░░░░░░▒██████▒░                  "
    echo -e "               ░████▒░░░░░░░░░░░░░░░░░░░░░░░░░▓███▒░                "
    echo -e "              ░███░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░███░               "
    echo -e "             ▒██░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▒██░              "
    echo -e "            ▒██░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░██░             "
    echo -e "           ░██░██░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░██░██░            "
    echo -e "          ░██░░██░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░██░░██░           "
    echo -e "          ░██▒░██▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░██▓░▒██░           "
    echo -e "           ░██▒░██▒░░▒▓█████▒░░░░░░░▒███████▓▒▒░░██░▓██░            "
    echo -e "            ░██░██░░██████████▒░░░░░▓██████████░░██▒██░             "
    echo -e "             ░████░████████████░░░░░████████████░████░       ▒░     "
    echo -e "   ▒████      ░███░▒██████████░░░░░░░██████████▒░██▒░    ░▓████░    "
    echo -e "  ░██░▒██▒    ░██░░░░██████▓░░░░█░█░░░░███████░░░░██░   ░███░░██░   "
    echo -e "  ░██░░░██▓░  ░██░░░░░░▒▓▓░░░░▒██░██░░░░░▓▓▒░░░░░▒██░  ░███░░░██░   "
    echo -e "░▓██▒░░░░████▓░░██░░░░░░░░░░░░███░███░░░░░░░░░░░░██░░█████░░░░▓██▒░ "
    echo -e "██▓░░░░░░░░▒████████▓░░░░░░░░████░███▓░░░░░░░▒▓████████░░░░░░░░░███ "
    echo -e "██▓▒▓███▓░░░░░░▓████████▓░░░░████░███▓░░░░▓████████▓░░░░░░████▓▓███ "
    echo -e "░███████████▒░░░░░░███████░░░░██░░░██░░░░██████▓░░░░░░▓███████████░ "
    echo -e "         ░▓█████░░░░██▓▓░██░░░░░░░░░░░░░██░█▒██░░░▒█████▓░          "
    echo -e "            ░▒█████▒▒█▓█░███▓▓▒▒▒▓▒▒▓▓▓███▒███░▓█████░              "
    echo -e "                ░▒████▒▓█▒▒█░█▒█░█░█▓█▒█▓░█░█████▒░                 "
    echo -e "                   ░██░░██▓█▓█▓█▒█▒█▓█▓████░▓█▓░                    "
    echo -e "                ░▓████▓░▓█▓█░█▒█░█░█▒█▒███▒░██████░                 "
    echo -e "            ░▓█████░░██░░░▒█████▓█▓█████▒░░░██░▒█████▓░             "
    echo -e "    ░██████████▓░░░░░███░░░░░░░░░░░░░░░░░░░██▒░░░░░▓██████████▒░    "
    echo -e "   ░██░░░▓▓▓░░░░░░▒██████▓░░░░░░░░░░░░░░░███████▒░░░░░░▓▓▒░░▒██░    "
    echo -e "   ░▓██░░░░░░░░▓████▓░░░█████▒░░░░░░▒▓█████░ ░▓████▓░░░░░░░▒██▓░    "
    echo -e "     ░███░░░░████▒       ░▓█████████████▒░      ░▒████░░░░███░      "
    echo -e "      ░██░░░██▒                                    ░▓██░░░██░       "
    echo -e "      ░██▒▓██░                                       ▒██▒▓██░       "
    echo -e "       ░████░                                         ░████░        "
    echo -e ""
    echo -e ""
    echo -e "           Committing directly into $branch is not allowed${normal}           "
    echo -e "  Start a new branch, commit your changes there, and merge them in  "

    exit 1
  fi

  exit 0
}; guard_master
